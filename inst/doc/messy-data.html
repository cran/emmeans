<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="emmeans package, Version 1.3.2" />


<title>Working with messy data</title>






<link href="data:text/css;charset=utf-8,body%20%7B%0Afont%2Dsize%3A%2011pt%3B%20font%2Dfamily%3A%20%22Palatino%20Linotype%22%2C%20%22Book%20Antiqua%22%2C%20Palatino%2C%20serif%3B%0Amargin%3A%2030px%2050px%2030px%2050px%3B%20%7D%0Ah1%2Ch2%2Ch3%2Ch4%2Ch5%2Ch6%20%7B%20font%2Dfamily%3A%20Arial%2CHelvetica%2CSans%2Dserif%3B%20%7D%0Aa%20%7B%20text%2Ddecoration%3A%20none%3B%20%7D%0Aa%3Alink%20%7B%20color%3Adarkblue%3B%20%7D%20a%3Avisited%20%7B%20color%3Adarkblue%3B%20%7D%20a%3Ahover%20%7B%20color%3Adodgerblue%3B%20%7D%0Aa%3Aactive%20%7B%20color%3Adodgerblue%3B%20%7D%20code%20%7B%0Acolor%3A%20%23602000%3B%0Afont%2Dfamily%3A%20%22Lucida%20Console%22%2C%20Monaco%2C%20monospace%3B%20font%2Dsize%3A%2090%25%3B%0A%7D%0A%2Er%20%7B%20%0Acolor%3A%20darkred%3B%20%7D%0A%2Ero%20%7B%20%0Acolor%3A%20darkgreen%3B%20background%2Dcolor%3A%20%23eeeeee%3B%20%7D%0A%2Er%20code%2C%20a%20code%2C%20%2Ero%20code%20%7B%20color%3A%20inherit%3B%20%7D%0A%2Evigindex%20ul%20%7B%20list%2Dstyle%2Dtype%3A%20none%3B%20%7D%0A%2Evigindex%20ul%20li%20%7B%20list%2Dstyle%3A%20none%3B%20%7D%0A%2Evigindex%20a%20code%20%7B%20color%3A%20inherit%3B%20%7D%0A%2Evigindex%20li%20code%20%7B%20color%3A%20inherit%3B%20%7D%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Working with messy data</h1>
<h4 class="author"><em>emmeans package, Version 1.3.2</em></h4>



<!-- @index Vignettes!Messy data -->
<div id="contents" class="section level2">
<h2>Contents</h2>
<ol style="list-style-type: decimal">
<li><a href="#issues">Issues with observational data</a></li>
<li><a href="#mediators">Mediating covariates</a></li>
<li><a href="#weights">Mediating factors and weights</a></li>
<li><a href="#nesting">Nested fixed effects</a>
<ol style="list-style-type: lower-alpha">
<li><a href="#nest-trap">Avoiding mis-identified nesting</a></li>
</ol></li>
</ol>
<p><a href="vignette-topics.html">Index of all vignette topics</a></p>
</div>
<div id="issues" class="section level2">
<h2>Issues with observational data</h2>
<!-- @index Observational data -->
<p>In experiments, we control the conditions under which observations are made. Ideally, this leads to balanced datasets and clear inferences about the effects of those experimental conditions. In observational data, factor levels are observed rather than controlled, and in the analysis we control <em>for</em> those factors and covariates. It is possible that some factors and covariates lie in the causal path for other predictors. Observational studies can be designed in ways to mitigate some of these issues; but often we are left with a mess. Using EMMs does not solve the inherent problems in messy, undesigned studies; but they do give us ways to compensate for imbalance in the data, and allow us to estimate meaningful effects after carefully considering the ways in which they can be confounded.</p>
<div id="nutrex" class="section level7">
<p></p>
<!-- @index Examples!`nutrition` -->
<p>As an illustration, consider the <code>nutrition</code> dataset provided with the package. These data are used as an example in Milliken and Johnson (1992), <em>Analysis of Messy Data</em>, and contain the results of an observational study on nutrition education. Low-income mothers are classified by race, age category, and whether or not they received food stamps (the <code>group</code> factor); and the response variable is a gain score (post minus pre scores) after completing a nutrition training program. First, let’s fit a model than includes all main effects and 2-way interactions, and obtain its “type II” ANOVA:</p>
<pre class="r"><code>nutr.lm &lt;- lm(gain ~ (age + group + race)^2, data = nutrition) 
car::Anova(nutr.lm)</code></pre>
<pre><code>## Note: model has aliased coefficients
##       sums of squares computed by model comparison</code></pre>
<pre class="ro"><code>## Anova Table (Type II tests)
## 
## Response: gain
##             Sum Sq Df F value    Pr(&gt;F)
## age          82.37  3  0.9614    0.4145
## group       658.13  1 23.0441 6.105e-06
## race         11.17  2  0.1956    0.8227
## age:group    91.58  3  1.0688    0.3663
## age:race     87.30  3  1.0189    0.3880
## group:race  113.70  2  1.9906    0.1424
## Residuals  2627.47 92</code></pre>
<p>There is definitely a <code>group</code> effect and a hint of and interaction with <code>race</code>. Here are the EMMs for those two factors:</p>
<pre class="r"><code>emmeans(nutr.lm, ~ group * race)</code></pre>
<pre class="ro"><code>##  group      race     emmean   SE df lower.CL upper.CL
##  FoodStamps Black      4.71 2.37 92  0.00497     9.41
##  NoAid      Black     -2.19 2.49 92 -7.13690     2.76
##  FoodStamps Hispanic nonEst   NA NA       NA       NA
##  NoAid      Hispanic nonEst   NA NA       NA       NA
##  FoodStamps White      3.61 1.16 92  1.31252     5.90
##  NoAid      White      2.26 2.39 92 -2.48897     7.00
## 
## Results are averaged over the levels of: age 
## Confidence level used: 0.95</code></pre>
</div>
<div id="nonestex" class="section level7">
<p></p>
<!-- @index Non-estimability; Estimability -->
<p>Hmmmm. The EMMs when <code>race</code> is “Hispanic” are not given; instead they are flagged as non-estimable. What does that mean? Well, when using a model to make predictions, it is impossible to do that beyond the linear space of the data used to fit the model. And we have no data for three of the age groups in the Hispanic population:</p>
<pre class="r"><code>with(nutrition, table(race, age))</code></pre>
<pre class="ro"><code>##           age
## race        1  2  3  4
##   Black     2  7 10  2
##   Hispanic  0  0  3  0
##   White     5 16 51 11</code></pre>
<p>We can’t make predictions for all the cases we are averaging over in the above EMMs, and that is why some of them are non-estimable. The bottom line is that we simply cannot include Hispanics in the mix when comparing factor effects. That’s a limitation of this study that cannot be overcome without collecting additional data. Our choices for further analysis are to focus only on Black and White populations; or to focus only on age group 3. For example (the latter):</p>
<pre class="r"><code>summary(emmeans(nutr.lm, pairwise ~ group | race, at = list(age = &quot;3&quot;)), 
    by = NULL)</code></pre>
<pre class="ro"><code>## $emmeans
##  group      race     emmean   SE df lower.CL upper.CL
##  FoodStamps Black      7.50 2.67 92     2.19   12.807
##  NoAid      Black     -3.67 2.18 92    -8.00    0.666
##  FoodStamps Hispanic   0.00 5.34 92   -10.61   10.614
##  NoAid      Hispanic   2.50 3.78 92    -5.01   10.005
##  FoodStamps White      5.42 0.96 92     3.51    7.326
##  NoAid      White     -0.20 1.19 92    -2.57    2.173
## 
## Confidence level used: 0.95 
## 
## $contrasts
##  contrast           race     estimate   SE df t.ratio p.value
##  FoodStamps - NoAid Black       11.17 3.45 92  3.237  0.0017 
##  FoodStamps - NoAid Hispanic    -2.50 6.55 92 -0.382  0.7034 
##  FoodStamps - NoAid White        5.62 1.53 92  3.666  0.0004</code></pre>
<p>(We used trickery with providing a <code>by</code> variable, and then taking it away, to make the output more compact.) Evidently, the training program has been beneficial to the Black and White groups in that age category. There is no conclusion for the Hispanic group – for which we have very little data.</p>
<p><a href="#contents">Back to Contents</a></p>
</div>
</div>
<div id="mediators" class="section level2">
<h2>Mediating covariates</h2>
<!-- @index Mediating covariates; Examples!`framing`; Covariates!Mediating -->
<p>The <code>framing</code> data in the <strong>mediation</strong> package has the results of an experiment conducted by Brader et al. (2008) where subjects were given the opportunity to send a message to Congress regarding immigration. However, before being offered this, some subjects (<code>treat = 1</code>) were first shown a news story that portrays Latinos in a negative way. Besides the binary response (whether or not they elected to send a message), the experimenters also measured <code>emo</code>, the subjects’ emotional state after the treatment was applied. There are various demographic variables as well. Let’s a logistic regression model, after changing the labels for <code>educ</code> to shorter strings.</p>
<pre class="r"><code>framing &lt;- mediation::framing 
levels(framing$educ) &lt;- c(&quot;NA&quot;,&quot;Ref&quot;,&quot;&lt; HS&quot;, &quot;HS&quot;, &quot;&gt; HS&quot;,&quot;Coll +&quot;) 
framing.glm &lt;- glm(cong_mesg ~ age + income + educ + emo + gender * factor(treat), 
    family = binomial, data = framing)</code></pre>
<p>The conventional way to handle covariates like <code>emo</code> is to set them at their means and use those means for purposes of predictions and EMMs. These adjusted means are shown in the following plot.</p>
<pre class="r"><code>emmip(framing.glm, treat ~ educ | gender, type = &quot;response&quot;) </code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2AAAAJACAMAAADcl/UUAAACBFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYAv8QZGT8ZGWIZPz8ZP2IZP4EZYp8aGhozMzM6AAA6OgA6Ojo6OmY6OpA6Zjo6ZmY6ZpA6ZrY6kLY6kNs/GRk/Pxk/Pz8/P2I/YmI/YoE/Yp8/gb1NTU1NTW5NTY5Nbm5Nbo5NbqtNjshiGRliPxliPz9iYj9iYmJigYFigZ9igb1in71in9lmAABmADpmOgBmOjpmZgBmZjpmZmZmZpBmkGZmkJBmkLZmkNtmtttmtv9uTU1ubk1ubm5ubo5ujqtujshuq+SBPxmBYj+BgWKBn72BvdmOTU2Obk2Obm6Oq6uOq8iOq+SOyOSOyP+QOgCQOjqQZjqQZmaQkDqQkGaQkLaQtraQttuQ2/+fYhmfYj+fgT+fvb2fvdmf2dmrbk2rbm6rjm6rq8iryOSr5P+2ZgC2Zjq2Zma2kDq2kGa2kJC2tpC2tra2ttu229u22/+2//+9gT+9gWK9n2K9n4G9n5+92dnIjk3Ijm7Iq27Iq47IyKvI5P/I///Zn2LZvYHZvZ/Zvb3Z2Z/Z2b3Z2dnbkDrbkGbbtmbbtpDbtrbb27bb29vb2//b///kq27kyI7kyKvk5Mjk5P/k///r6+vy8vL4dm3/tmb/yI7/25D/27b/29v/5Kv/5Mj/5OT//7b//8j//9v//+T///8fbPoCAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAgAElEQVR4nO2d/WMdVXrfR2Bq0c2ukE1iXEjTLCPWZtM07a4DxaQOq3QNm+wKugECzS5x0q3qgqhJHCDdFJHUmO1ixV7AgsSuJdvSWtL9JzPvd97nPM85z5k5c7+fH8C6L987eu7z0cycOTPjTQAAYnh9LwAAYwaCASAIBANAEAgGgCAQDABBIBgAgkAwAASBYAAIAsEAEASCASAIBANAEAgGgCAQDABBpAW7AiigeloINzMHCDYoUD0thJuZAwQbFKieFsLNzAGCDQpUTwvhZuYAwQYFqqeFcDNzgGCDAtXTQriZOUCwQYHqaSHczBwg2KBA9bQQbmYOEGxQoHpaCDczBwg2KFA9LYSbmQMEGxSonhbCzcwBgg0KVE8L4WbmAMEGBaqnhXAzc4BggwLV00K4mTlAsEGB6mkh3MwcINigQPW0EG5mDhBsUKB6Wgg3M4cZEOzywte0M37+zX/53w0sSieDqZ5q0f73YwsLjxNyZQsp3MwcIJgSEKzpZQsQrBUIpgQEq+dvFr72ASkXghlGrpjKQDAGyoJRVl9XIJhxpEr5yZ8vLPzKT5Lv92d/GOwJ/MZPwn+eW/j2T399YeE3ox+u/PSxhQe/lfRK7kWXFx4PnvmVH3z82IM/SAODN378WwsP/odot+Ir348e+9t/G2wAfeXff5D1RS5DBtnqmS5atIEYvbAY1lshhZuZg6OCffK98Kt98LejXvn4seiLfvDbV8Kv919HP0Rf47non/8uaoH8iy4v/Jvgp69+UBTsd6JXPB69KXr8zxcW0g6K+yKfIYNo9YwXLROsGNZfIYWbmYOjgv3NwoPfv/Kz34p2sH/+zYWvf3Dlk7+I+iP4VoO9guBP7bfD7//Bb1355FzyxeZedDlslFJi8LKvfxA8H77nZ98L33I5/IzgD3rYJFFfFDJkEK2e+aIlm4jlsN4KKdzMHNwULPhbHP7xC/4QPh7taEcPRl/2ubgLzsX/fjx+7ddKL7q8MF1zpcRvjBODFwQ/xG+PPyvqi0KGDJLVEyhaUoqasH4KKdzMHNwU7OPH4j+m4Vf3yfeSLz568Fz83YVf4c+/GT8R/rv4oss1f4vPJX+Lo9dlL/h//+ePgr/4cV8UM2SQrJ5A0WJFymH9FVK4mTm4Kdjl3J/AeM8i3YdI/lrGvRJvgVyOeiX/IkXBwq2piLQv8hkySFZPoGipYNWwfgop3Mwc3Bcs2KCv75WPH5v2SvFFdWPQ56Ltp3xfhHviD/7G7/y3dMummCGDZPUEihYLVg7rr5DCzczBVcHiv6Zxr+T3DRr+GBdfpCRYuBsSfsgn076o2QkxjGT1BIqWClYM66+Qws3MwU3BirsTC7nR3kKv5Hcn8i9SEix9e/D3NtuykRufT5CsnkDRsk3EQlh/hRRuZg5uCpZ8RcFXFg2IxY2TH7GKxqmKA2K5F5EEu7wQ/cWPBr9yGTJIVk+gaNkoYiGsv0IKNzMHNwULD+n8IHdI56s/uZIcxsn3SjRUHM5e+FrpRYRNxPCATtoXhQwZRKtnvmjT42D5sP4KKdzMHBwVrDAp4XI8L2Dh61eKvRL8NySelJB/UdorpalSV4r75vE8hYWv/kW2a5LPkEG0euaLlh7JKob1V0jhZubgqGDJtLpz+Wl10bS3Qq9c+emvl6fVRS9SE+zK3wZ/7L/yrWQzJzeF7vtSv5SduYgGi5YdKi6E9VdI4Wbm4KpgMefkhx3sYqN6oyvaFOFm5uCmYMnRGhsD53aRrN5oizZFuJk5uClYsJcc7jefkxvO6wnJ6o22aFOEm5mDm4Jd+Wm8kzy6v8Wi1Rtr0aYINzMHRwWLTuF78DcFT33sB9nqjbRoU4SbmYOrgo0UVE8L4WbmAMEGBaqnhXAzc4BggwLV00K4mTlAsEGB6mkh3MwcINigQPW0EG5mDhBsUKB6Wgg3MwcINihQPS2Em5kDBBsUqJ4Wws3MQVqwm8pQXmsjp5cF6r16g/saSDnCzcwBgokHQTBrOcLNzAGCiQdBMGs5ws3MAYKJB0EwaznCzcwBgokHQTBrOcLNzAGCiQdBMGs5ws3MQVowAGYarMHEg7AGs5Yj3MwcIJh4EASzliPczBwgmHgQBLOWI9zMHCCYeBAEs5Yj3MwcIJh4EASzliPczBwgmHgQBLOWI9zMHCCYeBAEs5Yj3MwcIJh4EASzliPczBwGI9h8AL38tUU2EgPBHMwRbmYOQxFsft6UYU63GrN6jv/WxnKEm5nDQASbnzdmmNOtxqse8UOsBEGwmGEINj9vzjCnW41VPeqHWAmCYDEQTDwIglnLEW5mDhBMPAiCWcsRbmYOEEw8CIJZyxFuZg7DEOwmBEtfy6ke8UOsBEGwmIEIZtAwp1uNWT3Hf2tjOcLNzGEogiUHmg0Y5nSrcavn9m9tLEe4mTkMRrCkkvqGOd1qmtUzAAQzy9AE0zfM6VbTrZ4+EMwsgxNM2zCnW027etpAMLMMTzDdab9Ot5p+9XSBYGYZoGCahjndagaqpwkEM8sQBdPbTHS61YxUTwsIZpZhCqZjmNOtZqZ6OkAwswxUMA3DnG41Q9XTAIKZZaiC8XfEnG41U9XjA8HMMljB2IY53WrGqscGgplluIJxNxOdbjWD1WMCwcwyZMF4hjndaiarxwOCmYUl2MH5Zd8/e6nw0IfBQ994ufJSvUpyDHO61YxWjwUEMwtHsL0VP+SJj6YP7cYP+c+XX6tZSYZhTrea2epxgGBm4Qi27p+8NNld9U/eSB85WPVPXJoc/J2/9FbptbqVpA91ON1qhqvHAIKZhSHYznK07tpbmdq0nazONv0nSy/WriTZMKdbzXT16EAwszAESy3a9F9IHglWYK80vNhAJYmGOd1q5qtHBYKZhSHYemLTdra62lvJ748VMFFJmmFOt5pA9YhAMLPQBTtYTTYNd5bTnbDwX1/8ge+feDN71UMJJpZxEhhmJAcA25gS7Hw8iphuNJoVLDQMigEX0RIs3TDcDgfob0wOPjQ/iphAGOpwemNJpnoUsIloFiNrsO101bVufhQxRdkwp1tNqnr2gyBYjKFNxMpDKeYqqWqY0602kaqe9SAIFmNkFDHbWJxuNaYYrKSiYU632kSseraDIFgM6zjYC4X/51Zq277cGkzVMKdbbSJXPctBECzGzEyOdN9rfTqMmGC0kkpDHU63mmT17AZBsBiGYPHEw8JcxJ3lcHK94ChigophTreaaPWsBkGwGM5k393cbPpkfGN7OXpoqTJjynQluw1zutWEq2cxCILFsM4H2w0PK5+N1l/pAOJueIrYdy9VXmq8kp2GOd1q0tWzFwTBYgZ9RnMtXYY53Wri1bMWBMFi3BOsyzCnW02+eraCIFiMg4J1DHU43WoWqmcpCILFuChYu2FOt5qN6tkJgmAxTgrWupnodKvZqZ6NIAgW46hgLYY53WqWqmchCILFuCpYs2FOt5qt6skHQbAYZwVr3BFzutWsVU88CILFuCtYk2FOt5q96kkHQbAYhwVr2Ex0utVsVk82CILFOC1YrWFOt5rV6okGQbAYtwWrM8zpVrNbPckgCBbjuGA1hjndaparJxgEwWJcF6w61OF0q9munlwQBItxXrCKYU63mvXqiQVBsBj3BStvJjrdaj1UTygIgsWMQbCiYU63Wh/VkwmCYDGjEKxgmNOt1kv1RIIgWMw4BMvviDndav1UTyIIgsWMRLCcYU63Wk/VEwiCYDFjEWy6meh0q/VWPeNBECxmPIKlhjndav1Vz3QQBIsZkWCxYfS7pjcBwZzLEW5mDmMSLJJr3phhEMy5HOFm5jAqwcwaBsGcyxFuZg4jFcyEYRDMuRzhZuYAwRqBYM7lCDczB2nB7DIVrO8lASACa7BGsAZzLke4mTmMS7CbBv2CYO7lCDczh5EJdhPD9JpAMLOMTbCbEEwPCGaW0QkW5mATkQ8EM8soBbsJwdhAMLOMVDCMInKBYGYZp2BGDINgzuUINzOHkQpmYiMRgjmXI9zMHEYrmL5hEMy5HOFm5jBWwQyswiCYcznCzcxhvIJpGwbBnMsRbmYOoxVMfxUGwZzLEW5mDiMWTNcwCOZcjnAzcxivYNqrMAjmXI5wM3MYs2CahkEw53KEm5nDiAXTXYVBMOdyhJuZw6gF0zMMgjmXI9zMHMYsmOYqDII5lyPczBzGLZiWYRDMuRzhZuYwasH0DINgzuUINzOHcQumtZEIwZzLEW5mDmMXTMMwCOZcjnAzcxi5YDqrMAjmXI5wM3MYvWB8wyCYcznCzcxh7IJprMIgmHM5ws3MYfyCsQ2DYM7lCDczh9ELxl+FQTDncoSbmcMMCMY1DII5lyPczBzGLxh7FQbBnMsRbmYOLMEOzi/7/tlLuUf2VvyIJz4qvVSokpQc7ioMgjmXw2lmYTiCJTblZdpZHq5g3FUYBHMuh9HM0nAEW/dPXprsrvonb2QPbftP1r9WqJKkHOYqDII5l8NoZmkYgu0sR+upvZWlt7LH1v0X6l8sVElaDs8wCOZcDr2ZxWEItpmsrTanUh2s5mQrIFRJYg4Esx4EwWIYgq37r0T/z20W7q2c/L8v+v53L1VeLFRJYg5rFQbBnMuhN7M4dMGytdXOcrYTlo5xJOoFPJRgZCH1wU3RQT+YEWzb95+/MfnleT/bUhyaYDAM9EKrYPuf1TyYEywblE93y6pjHULbAuQcxjYiNhGdy6H3vzjNgl172gt55L3S43VrsJRtv/yQUCXJOYy9MAjmXA5LAVmaBNt/1Us5fr3wTJtguZVaglAl6TkQzG4QBItpECz0a+7Yjy7+5TOBYYeLz9WMIqZUnROqJD2HvgqDYM7lcC0QpEGwLc97NP7X/gXP+07hufT41/Q42MFqo3NClWTkQDCrQRAspl6wYAX2aPbDWmkVVjOTYz0WKxNtilAlGTnkVRgEcy6H74EY9YLdOzX3Z9kPtxfvez//ZKDRidJcxJ3lcJh+98XKGMeABCOvwiCYczl6LojQJFjOqcIPIbu52fQ7y9F6bDOZTF+ZyiFUSU4OdRUGwZzL0bVBgKZNxMIa7IHiOOJk93wg09loZZUINtl9yfeXni+vvwYlGHUVBsGcy9ExQYiGQY6N3H7XRm5/jIxQJVk5xFUYBHMuh9+nYjQIdu+U96+S1daGV9pCJCFUSV4OzTAI5lwOv0/FKAu2//rpiGfi42B/dXrR8449e732vSoIVZKZ04dg8/MEr3uvHgQzTFmwYNVVRWMVJlRJZg5pFWZmgebnKYb1Xj0IZpjZEoy0CjOyQPPzJMN6rx4EM8wMXLYtD2UVZmKB5udphvVePQhmmMEIdiuAXv7aIrc9C8EsBUGwmKEIduuWKcM6BKMMOGgvCwSzmyPczByaBbv7zlHPmzt65nOtfMXK3LplzLCOz4RgdoIgWEyjYBvZEIfGYWbV6ty6Zc6wLsEII3ray4JBDrs5Op0qRJNgoV/3Hzv9zBFNw9QKY1Ew9VWYScHUP5NRvfiNnKUTDIJgMQ2C3V70HoivFXDnVS83L5GMWmGsCqa+NtFeFuphMAiml8PvUzEaBFvzsgm++6+WT2mmoFYYm4Ipr8LM7INhqpTFHH6fisGaTU9AsTL2BjnUV2EGWmQeglnNYbepHJzzwSiolsbcKqz7MxUN02+ReOMQglnLYbepHEMRLD7QbMIwhc+0JFiy8wXBrOWw21SOxmtyTC90s+XJbyJmldQ3TEUwJcN0WyQd3IBg1nLYbSrHMAY5cpXUNkzlM20Ilg0eQjBrOfw+FaN5mP7Qu9G/Pn3KwjB9vpK6hikJpmKYXotMB+chmLUcfp+K0Xag2Tt69KjuVA5GJTUNU/pMccFyB78gmLUcjUaVonGq1NXFZKbU3HM6+ZxK6g11qAmmYJimYKwcA9XTBIKZpXmy7/61Z4I12LE3+AMcIaxKahmm9pnCguUFhmDWcrRaVYahnK5SqqSGYYqCdRum0SLzEAyCxTSNIlbuWsSEW0m+YYqfKSlYcfYhBLOWY6ZnjdJ0oLl0wwc27EqyDVMVrNMwdouUZvdCMGs5xOa8+qvU/R/6OxRmcmjBryTXMNXPFBOsPHseglnLofXmGnkGBf0dKpN9tdCoJHOoQ1mwLsOYLVI5OwWCWcuh9WaPgk020tPBdNGpJM8w5c/sMozXItWzvyCYtRxab/Yp2N0L0QnNCRpX9tUjMEwwfV4ic14iFUjQo2Cly4/2d+FRxjpM/TM7VmGsv8E1mViDWcuhdOZGesWZcGb7taeCFUq4V3TntUXPm5uOoX8a/uwdPXM9/w4KAxeMYRjhM80LVucsBLOWQ+nMvGCn0y7PLvV0PHrN/tvpz4feNyqYObQrSTaMIlirYYwWqb38BgSzlkPrzWSDLxAsnM9+541IoXDldfftxLDg5+PBS+4E67fDuXdQGLxg5KEOymcaFqz+8jYQzFoOrTdzgsVHfW8vpmdmbUSnkAQbcvHPwT+ilxoX7DNiWhUDlSQaRhKszTByizRcPgqCWcuh9eZUsGQfaHorvPgkyK30TK30JUYFu/Z0NJdec86UkUqSDCN9IyYFa7o8GwSzlkPrzalgsTb5U4tLKq0ZFyxcb6b7ezqD9GYqSTGMJliLYcQWabz8IQSzlkPrzalg2YZgzcje3U8vvn7EMy1YtON37McX//KZRU/nigGmWoRgGO2bNSZY8+VFIZi1HFpvKgh29UjhR5MzOdJ7NO9f8HQm/pqqpLphVC/MBLVcvheCWcuh9WaNYMV1SbwZd/T0jz43vYkYJE9H+9esXvSmCeWhDuqWnZkgQ6JKVc9+kIOCZTtjKRvZ/pFpwe6dKlzZdxC3kFU1jLzrZCLI1L6cWPWsBzkoWPBA2vaRa1PhgnWbacGsX3hUoZJqhtEH//SDWu/vAMGs5dB6syJYeMuTWKCtcL9oKtiG6X0w69emV6ukkmH0w1faQe33T4Fg1nJovRkeTd7/PD86H4h06I143CHs+WQT8dOnPC9etyXvoNA4yHG49t9kzFZSxTDG8WHNoI77E0Ewazm03twKhzAOFw5/ZXMRo3XKvaeSnx5JRvqSd1BoHqZPD39t6Mz1Nd0iCoYxZjjpBXXd/wuCWcshNmd4acLD1wuXrr7zWjgw//Ab8U/77xwJ51q8mw0wxu+gfEbDJuLr4fGvY2cu/lX4/4c1zgozXcluwzhTCHWCOu+vB8Gs5TAaVBql01U0TloxXsnOwUTGN6sjWPf9KyGYtRxGg0rjnGCdhnEE40/SVbg/LASzlsNoUGmGf7pKlXbDON+sjmCdL4Fg1nKEm5mDi4K1G8YSjHsel+lr3Nuonp0gCBbjpGCthrG+WaZgChuIEMxijnAzc3BTsDbDeIKxTvVX8guC2csRbmYOjgrWMtTB+2Y5gqn5BcHs5Qg3MwdXBWs2jCkY/XJrin5BMHs5ws3MwVnBGjcTmd8sWTBVvyCYvRzhZubgsGANhnEFq+jSHqTsFwSzlyPczBxcFqzeMO43S7umvLpfEMxejnAzc3BasFrD2N8sUTDlXAhmLUe4mTm4LVjdUAdfMMJthwh+QTB7OcLNzKEi2N3PqtBOMSsgVMmMqmH8b1ZdMMIGIgSzmMPvUzHKgilN8z04v+z7Zy+Vs3aWT94oPyZUyRxlwzQEU70zJckvCGYvR9cGATiC7a34IU98VHzrwarfh2BlwzS+WUXBaH5BMHs5BoQwTVmw/V9cjLjgeXPP/vjixT894s2d+eviqZbr/slLk92KTpt+P4KVDNMRTOnm5US/IJi9HFLr/38CpOACDYMcwYosvTDi1fIKbGc5WnftrSy9VXy4L8GKhul8syqCUf2CYPZySK3fq2BruQuPli96s+k/mfz/hdyjwQbif+llHywkP9ShJVjenfogsl8QzF4OqfX7FKz1sm3r/ivR/7cT0dJHn+xnkCMiZ5hWTqdgdL8gmL0cUuv3KVjbhUcPVpNNw4JP28HmYf6BhxL4S0bEzP3SO29hjnucj4Z+BWu+dHatYNEOWa+CmTKs42n4NRr6FKxww4fSzR9ygk0H6tfD/bEeNxFDkq1EvZzcFmBNEGMDEZuIFnNIrd+rYFvZfSXCG60Xbl9UtwbbjMYPexYsNox6S+cyU4WqC8TyC4LZyyG1fq+CBaut+IKj4XVOjxeeqRFsZzl6qG/BIrluaRvWuEA8vyCYvRxS6/crWLjiSni09FR1FHHTzyhP7xCqZAMmDMssKi8Q0y8IZi+H1Pr9CjaZ3A2vy+3df6Yy0zc9/jU9DjY8wbQMq18grl8QzF4OqfX7FqyRhpkcA9hENCTYfN0Csf2CYPZySH08AMHqb4V0sOqfqJuLOBbBbtYJxvcLgtnLIbV+34JdezqcRn/vd89Ubqqym5tNn4xvRIxGsPnqAvH9gmD2ckit369g8SBHINgp71Dlpg+75wO/zkYyDUuwmyb8Sldh+QXS8AuC2cshtX6/gq153qHfW7zv/f0/8ej3pc0hVMlGTPiV6JRbII0NRDuCGfilsyVwOIfUmnqC7b+26HmPvNf5Kc0Hmp9LJiFeXSweaKYhVMlmzBgW/me6QFp+2RDMyC+dLoGRmLELlpyY3H1Lr7bTVZJZvgO6R7NqjpFVWLZAen5ZEMzMhnG6BCZSXBUsrKKSYGveA+9N7rzavXXXdrpKIlhpsi8NoUp25BhZhaULpOmXvGBmhnayJTAQ0lcOqTUb/Ko1rPzexInCpPh62k5XSQQrna5CQ6iSXTnawxzz2QLp+gXB7OWQWrPJrzrDyu9Nt+o2KvOcyoxUMBMbiXGQtl8QzF4OqTUb/aoxrPzetWRcYqtz96lpEzEMSMza0hlGFKpkZ46BjcQoSN8vCGYvh9SaBaVaqBEsO+O/fLZ/lYZBjmgVGAsWyObcIMdNExuJkVv6flkc5IBgFHoV7Paid/x6JNidp7zOHbkWhCqpkGNCMAPrL4vD9EYMmynBuJuIOcG6dp+aDjRveJ53dHHu2JGa81UoCFVSIUd3upRLgiUHmk0oNsOCqQ9y6K/BJpN/WGw6H4yEUCVVcvRm1LslWLbnqW3YLAumPExvQrDJ3XeOhueDKcwGaUOokio5Or3mqGCtd4enBenipGDKB5p1RxHNIVRJpRyNXnNWMG3DZluwJsrvTY9/cY+D7b/+7HTNd/uZX3VvmD5iFgXT3UyEYCqCmZnJUfcDFaFKquUYWIWZXSCF1+pXT88wCKYi2P6r3iGduYgFpxyci5iibZiB5bEumN5mIgRTEWxyhz2bvu4GYQ7O5EjQHOfQXpgQ+4LprMQgmJJgkzuvBWI80i1GdQ22VRXMpfPByn/LDQVp0INgGoZBMDXBVKkKtv+/Tp9+ZnHu2OmU//QuP75vwXRWYS4Lxt9MhGDSgoVojWsUEKqkco5jeyMGq8dciUEwG4IVhum1EKqkeg7fMMcFYxoGwWwIZg6hShJyZlYw3mYiBLMr2Gf86AihShJynBpPM1w9hmEQzJJg++88HJ3UrHJpqhaEKknJcWk8zXT16JuJEMyOYFuLXnzVAM+b0xilH4Jg3I3EMQhGNwyCWRHs9mJyePkXry06esLlFIcGrAWqRzQMglkRbC2cahXj6CUD8sy0YMSVGASzIVjbTdAdxMjt0d0lNKzvZRgg/Qo2itn0Gc4cchWqHmEdhjWYW2swoUpSc2ZcMMJm4uwIZofGfbDDtf8mI1RJao4rcxrEqqdsGAQzS/PdVR6Jb295922XZ9NnODKnQbB6iobNjmB9biJG9wfz5o4ePRpeW0pjBTYYwRgbiSMTTNEwCGZHsP0L6clgc7/PTx+SYE5MGhKtntJmIgSzI1ig2LVngjXYsR/pTasXqiQjB4IpGQbBbAlmBqFKMnLIq7DxCaaymQjBIBgzx4Vpr+LV61yJQTBZwfZfP/3s9fC/eTTOvhSqJCsHgt3sNgyCyQp271Q4i750aSn3DzRHODCv3Eb12g2DYBCMnTP8eeVWqte6EoNgsoKZRqiSzBwIFtFmGASDYPwc0ipsvIK1bSZCMAimkQPBEhpXYhBMWLC7n1X5nJ8vVEluTg+nHpLOd7RXvabFgmCygtVdmn40gxw3SYaZWSDavZNtVq9+sSAYBNPKsSwY8e7kVqtXu1gQTFaw/V9cjLjgeXPP/vjixT894s2d+etxHGiOsHtu7/TG9aqfabN6dcsFwZQFu3dK4TyThkGOYEWW3hvzqs4KbHiCqRs2fsHqDINgyoIpnYnceEbz9N6zGyM4ozkPBCsuoJmgMm4KFt4UTlGw/TWlMyUbbv7wauGaHO7egK8Om1enGLxglZXYTAsW39ZUSbBrT6mdijwbV5UqYvPyL0Me5IgpLd0sC5bemFtBsA3PO35VR7CRXVWqgM3Lv9D86kOw0mbiDAs2P99oWOXNG4femGxp7YON66pSRexd/oXoVz+CFVZiMyXYvAoN+2ATLcG2gjVgvOO1P46rShWxJFjcuIOcKlUkZxgEsyJYdFWph0+fPn0k+P9x0nIXEaqkZo6d6yslbeuAYLnNxJkSjL+JGKIlWLjiSni04SVKCFVSN8eGYGnPOiEYa2nbcFAwyiBHiJZgk8ndd8K11/1nNGb6ToYrmIJhmgvEWif0WL14fcu8dXoVFwWjDNNPtAUzg1AltXPErxDI26vps3rUY3btOCkY5UCzCcH2G9ZeB+eXff/spfxDX77o+0s/vFF5qVAl9XOEBWOOy/VbPZOGuSlYE7UBmoJdezqcRn/vd89UpnHsrfghT3w0fWgzesQ/8VH5tUKV1M+RvQRnvkkdFMyAYRAspn2QIxDslHeofJh53T95abK76p/MVlg7y0svTya7L/pPlnOEKmkgR/ISnOxDt/1WD4LZE2zN8w793uJ97+//SXKz5ik7y9G6a29l6a30oXX/hdwzeYQqaSJHTjD+5KN+qwfBrAm25XnPJZMQry6WDjRvJuupzdiqHHsrTgnW0UY68431XKYAABZ/SURBVGe5Of1WD4JZEyw6XSWZ5Vs+XWXdfyX6/3Zlg3Bn+WR5mEOokkZyhAQr96c7glGnJrcxA4Ip0Xa6SiJYabLvwWqyaVjR6YvlRL2AhxL4SyaPyK3Bw/4UiLVEIljfi2GFPgWL1UoEK52u0iTYuu8vvZn95IJgEoa53p7R8jv9GyjjgGD5Pa6D//Gfl/2lPy4nCW0LGMoxfhuEus0rhzYRkyDsg8lvIoYDG4lZW8VhxOZNxMmXuW3EBKFKGsoxfRuE2t0X9wQzYRgEi2kY5IgGNmLBAtkKgxwtgk22/fJDQpU0ldPWSfQFqh8ecFAwxh2t63P0Galgtxe949cjwe485eXObg5pHkWscU6oksZyTArWMPzmpGDahkGwmKYDzRue5x1dnDt2pHq+Snr8a3oc7GA1cc5BwczdyKdpeNtFwfQNg2AxjXMR/2Gx6Xyw2pkcTxb+P0WokuZyjAnWePjIScG0DYNgMW3ngx0Nzwd75L3yE8H66kRlLqL//I3JwYf+1LkEoUqayzF1p6zmw7NuCqa7GwbBYjjng+3mZtPvLEdObcez6ZfKg4jDF6zZMOJoiRFRe69eTjA9wyBYTNNUqeqKK8fu+UCms9H6KxFssvtSoFfxFLEIoUqazDEhWNv0IkcF0zQMgsU0HWjWuZJUHqFKmszR33dqn77nqmB6hg1fMDsoXNlXC6FKGs3RHf3rmB5rQ7DwVHf1T2lfgum/IZg+Ctem10KokmZz9ATrmn1uQbD4Yi3qH9O6BNN/66zCIFhM40yOB9p2wtQRqqTZHK0DxJ1nd8gLll5uTP1z2pYg94OGYRAspkGwuxc87/5jpxOeHdXdVWrQEKz77ClxwaYXzFT/oJYlyP8EwXRpHOQY6y1ka+HPIVQ4O9FpwdiGQbAYCBbBnQWvcvavy4LxDYNgMbN64dEyPMGUzq53WjC2YRAsBoLFsE6UVLt6hb1BDhOGVT4UgmnRIJjeBelzCFXSfE7Vlc4gxavDWBumN2JYVTCeYRAspkaw/bfDifT3P8cfOswhVEmBHLJgqldfsnig2YBi1Q/lGQbBYqqC3U7PU6lc0ZeDUCUFcip91B6kfnUzm1Ol9A2r+VCWYRAspiJYNIB4/6+FJ1o+YGAdJlRJiRySYKQbm6svg371dBWr+1AIxqci2IYXXyLg2qLWrWNThCopkVM2pi2Idt9l9WUwUD1Nw2oFYxgGwWLKgu2/mnoVmKZx8/MUoUqK5KhfkZd08VvLgmkqVvuhDMMgWEyNYMk832BfzMA2olAlZXJUBaNdXNq6YDd1xhPrPxSCcSkLFuyCJfM2pv/SQaiSMjmKN20gXrzdvmA6K7EGwciGQbAYCJZH6bZD1Jsj9CEYX7GGDyUbBsFiIFgBBcHINx/pRzCuYc1/VszkUIFg7QhVUiqn+86U9Jv79CQYU7HmDWNDOUQgWDtClRTL6RKMcfOs3gRjGday52kmhwgEa0eokmI5HTcv59ycrj/BOIq1jZ2ayaEBwdoRqqRczrSN6mblSR9yNV49smGtR//M5JAYoWBVxn/CZY5mwZg3V+1VMLJirfNXDOVQgGDtCFVSMCeTqBzEvXdxz4IRDzu3TxAzskAkxibY/uunq4z+ojcF0jYqBbHvDd63YLSVWGuQ0AxMYznsNpUDZzRXqRWM7dcABKMo1h5kXTDaZrlwM3OAYFWSr7QQxPdrEIKpG9YhmHIVzHydt26RDBNuZg7SgjnJreojt6qPOUaomH6K3TrcSrD5mYbBGqyG+G9mLkhj/TWQNdhN1ZVYV5DEedzNn5Wi+AbhZuYAweqIvtFpkJZfgxFMTbHOIAhGAoLVUhBMz68BCaZiWLdg5i/10/xREKwL9WoOS7Bb0yBNv4YkmIJi3UHmL1bX/EkQrAv1ag5KsLCL4iDm9A3mAslXr8swhSDjl1tt+STaMKJwM3OAYA0kX6y+XwMTrEsxlSBbglH9gmDtxWF8BXI51K2TZoYmWPvcKSXBDF+Rv+lTgs/BgeYOKMWhfwdyOeb8Gp5grSsxpSDD95Rp+IzSWK4Cws3MAYLVQt69bmGAgrUophYkL1haegjWDqU4tG9ANGf0gjUapiiY0dsO1uU3TLnu+tDBAcFqGb9gTYopBhm9cW5NeuNJQx0fOjggWC2zIFi9YapBJm/9Xs1uv3BDy4cODghWjzm/hitYrWLKQWKCFcsOwdqhFIdQSfkcY34NWbAaw9QFay8O+2solR2CtUMpDqGSFnJM+TVowaqKqQe1l4e7QOWqQ7B2KMUhVNJCTi8L1EP1SoedCUGthvEWqPpXDYK1QykOoZIWcmZFsNJKjBJkXLCarQYI1g6lOIRKWsiZHcEKipEEazGMs0B1G+UQrB1KcQiVtJAzS4LlDCMFtRhGX6D6nV4I1g6lOIRKWsiZKcEyxYiXKTUoWMOgEgRrh1IcQiUt5MyYYLFa88SbYzavwqgL1DRmC8HaoRSHUEkLObMmWDKeaMow2gI1HxOBYO1QikOopIWc2RPMqGHEfTkzogo3MwcIJh40bsGadsNoo5GG9uWEm5kDBBMPGrtguvtO7VNmIFg7lOIQKmkhB4IpUq8HYU6juRkhws3MAYKJB7kj2E2OXw2GqS5Q14xPCNYOpTiESlrImUXBuIaxF6h7RjUEa4dSHEIlLeTMpGDZ0TDSm9gzMBTOWJhJwQ7OL/v+2Uv5h758yfeXig9FUIpDqKSFnNkULA4yYJjKAqmcEDSLgu2t+CFPfDR96MPoEX/prfJrKcUhVNJCziwLRjesIaf1PUon3M2iYOv+yUuT3VX/5I30kW1/6eVJ+FBeughKcQiVtJAz04JRDauq0rlAiie0zqBgO8uRRnsr2frqYNV/ZRI9FP8/B6U4hEpayJltwbQN61og1fPFZ1CwTf/J5P8vJI/srSRrrvXsoRRKcQiVtJAz44LpGta+QOrXY5hBwdaT1dR2IlrhKQimldN79XJBVMOacupeS7kjEWEZ6M0sDl2wg9Vk03BneboTFpPbanwoQXPxQI/QbupMuJPyLafvukzDqGCb03UaBBsBtLumq1pza5b80hOsNGa4jWF63Zzeq1cM0tgNa1wg4uXwsImYsb28VB5DhGDEnN6rVxaMvRvWtEDUq01CsJTNmvUXBCPm9F69UhD/zJX6BaJfzXX2BGsYRfyw1i8I5rZgfMNqF4hxteQZFCw9/rWZG5M/WPdPlCdxRAhV0kIOBIvgnt5ct0Cci5HPoGDVmRzR7KkbtS8WqqSFHAgWw7xCR3WBeBf7n0HBDlb9E6W5iJtNfkEw5wVjGlbJYd5MYwYFm+zmZtPvLAfrsWR6fUh5codQJS3kQLAUlmHlHO69amZRsMnu+UCls9E6KxJs24dgZnJ6r15tEM2wuhz+vaBmUjACQpW0kAPBplAMS0wq5Gjcaw2CtSNUSQs5ECwH3bB8js6tDCFYO0KVtJADwfKQDZvm6N0qFIK1I1RJCzkQrADJsHyO5q14IVg7QpW0kAPBihAMC41Kc3TvdA3B2hGqpIUcCFaCZFiy3tK/kzwEa0eokhZyIFgZumH6fkGwDoQqaSEHglVQNuxWhujy1Lx4cEAw8aDxCKZqmEG/aNfxFm5mDhBMPGhEgikaZk4w4pXyhZuZAwQTDxqTYGqGGROMei8K4WbmAMHEg0YlmJJhpgQj369MuJk5QDDxoHEJRjJMc1kgWDfq1YRgN50QjGCY7rJAsG7UqwnBbrohmLJh2ssCwbpRryYEu+mIYEqXSzSxQORbRgs3MwcIJh40PsFUDNNfIMYt2YWbmQMEEw8apWCdTa+7QIlZONDcAaU49G9BMgeCtdDd9noLNF1xYapUO5Ti0L4D6RwI1kanYToLlN8uhGDtUIpD+Q7kcyBYK12GaSxQYbMQgrVDKQ6hkhZyIFg7HYaxF6i01wXB2qEUh1BJCzkQrIN2w5gLVBk1hGDtUIpDqKSFHAjWRathrAWqGZSHYO1QikOopIUcCNZJm2GMBao95gXB2qEUh1BJCzkQrJsWw+gLVH/IC4K1QykOoZIWciCYAs2GUReo6YgyBGuHUhxCJS3kQDAVGg0ji9oQBMHATBOIYSLDQMowwRpMPGjUa7DGdRhpuN/UYIlwM3OAYOJBIxeswTDKAWtjx9OEm5kDBBMPGrtg9Yapz2k0OOVKuJk5QDDxoNELVmuYUo7C2V4QrB1KcQiVtJADwdThHSBWOpkSgrVDKQ6hkhZyIBiBqimdOYrnKkOwdijFIVTSQg4Eo0CeQ6h6qjIEa4dSHEIlLeRAMBJlX9pz1K8EAMHaoRSHUEkLORCMBuE0E9qV2AjLINzMHCCYeNCMCFYyrDmHeqEowiIINzMHCCYeNCuCFQ1ryqHpBcG6EKqkhRwIRkZBMKJeEKwLoUpayIFgdLouVkPWC4J1IVRJCzkQjE7On5oc6tYhfXmEm5kDBBMPmiHBcoZVclh6QbAuhCppIQeCccgkKuUw9YJgXQhV0kIOBGNRf8lrrl4QrAuhSlrIgWA8EpXyOXy9IFgXQpW0kAPBmMQ2TXPYW4f05RFuZg4QTDxo1gSLDMuk0tMLgnUhVEkLORCMzfTGebp6QbAuhCppIQeC8ZnPYXN5hJuZAwQTD5o9wczpBcG6EKqkhRwIxsagXxCsA6FKWsiBYGwg2BQIJh4Ewawtj3Azc4Bg4kGzJ9hNc35BsA6EKmkhB4JpYMwvCNaBUCUt5EAwHUz5BcE6EKqkhRwI5l6OcDNzYAl2cH7Z989eKj26t/Jk9aVClbSQA8Hcy+E0szAcwfZW/JAnPio+vO5DMN2c3qs3uK9hFgVb909emuyu+idv5B48WPchmHZO79Ub3Ncwg4LtLEfrrr2VpbemD375og/B9HN6r97gvoYZFGwzEWnTfyH3mP/8FxBMO6f36g3ua5hBwdb9V6L/b+eE2jzxZuHnDKFKWsiBYO7l0JtZHLpgB6vJpuHOcmEnrCjYQwl6SweA40AwAATREqw4UI9NRP2c3qs3uK8Bm4gZEEw/p/fqDe5rgGAZEEw/p/fqDe5rmD3BakcR636OEKqkhRwI5l4OvZnFYR0He6Hw/xQIpp/Te/UG9zXMoGC1MzkmDYKpY2rE0djI5eAWyMqHDO23dn0gmiHYwap/ojoXEYJJ59j5kKH91jMo2GQ3N5t+Zzlbj0Ew2Rw7HzK033oWBZvsng/8OhutvyCYtRw7HzK033omBRNhcN/I4BbIyocM7beGYKYY3DcyuAWy8iFD+60hmCkG940MboGsfMjQfmsIZorBfSODWyArHzK03xqCAQAagWAACALBABAEggEgCAQDQBAIBoAgEAwAQSAYAIIMQrC9lezyOek/D/7+D3zf/+6bFt5uLPEfw3tiLFVuihFn5CINo/vrGy+fU9WTZqCC7Sz7MScU6qr5dkOJB6vJK0onek/sC0b79Y2Xz6nqSTNMwYJynwz/lH35osopMJpvN5O4t+J/4+Ubk8kvP6z2iGXBiL++8fI5VT1p+hPs4Ivn039WvpHt9GzpynUJ6tB8+4cv3yg/xEhcz07w3qzc2KmmRcoXNKFirnqa73eyehbpS7CDv1+e/jWrfCOb2XPrCqXUfPu6v/TDUpPQE3NXYQ3+XkcviU9LvTQRaBGT1dN8v4PVs0o/goUNkvteav7kUbYINN9eWhheYr5zfhllbcf7HUuvGG8Rs9XTfL9z1bNMH4IdfLjsn3gz90DlGwk2yZd++E+qeZpvn0Q7B0vP55qEnBj83X2l+EiwX3/2n4Jf1Q82ioy2iOnq6ZfPpepZx75gwX7s0vPFaif3pPWn19LZDe/n53/3fyp9zZpvT5Zq2Z8uFTmxunORbhaFN9Y12CLmq2eifK5UrwesCxb8tTpb3i2ufiOTg+iWmX71tTVovj1dsPPT69CREystkv1RDnfwiy0yHZGmbcol7zVdPTPlc6J6fTCQNVjlyGTIP4ZHJxWqqPn2ZKmKf4OJidkF+6cJyQNpexhqEfPVM1E+V6rXA8PcB8vYXeGMItLePlHYi+hKrOxFZG+rtkiE5D5Y18KW0C6fS9WzziBHEXObDNvl6wfXoPl2hXGw7sTN3CHUbf/5Gy1/g5PXi40iEn99zfc7Vz3LDPI4WO4vGkcw4tsVjuR0J+bvRhjumbfsRUQIHgcj/vqa73ewelYZ5kyO6eH8dYXZOppvV5mL0J04nYvwRTi2LD0OZq56mu93snoWGeZcxPDASfjF7Z73OVOlaG83k5jOpgtnIITffnwk55fn5Y/k6P76xsvnVPWkGaZgyYETPz6UL/x2Q4nZK5Ivv30ugkF0f33j5XOqetIMVLDJwZcvBfX9htKEAs23G0v88qXCGU2ts+kMovvrGy+fU9WTZhCCATBWIBgAgkAwAASBYAAIAsEAEASCASAIBANAEAgGgCAQDABBIBgAgkAwAASBYAAIAsEAEASCASAIBOOz5j1w3dab999Z9Lz7/qzzdRvefe+zlwmYB4LxsSnYmheg4A4EGxgQjI9FwW4vev9C6eUQbGBAMD4WBdvyvO8ovRCCDQwIxseqYHPd+18hEGxgQDA+EAx0AsH4VB2589qi58098l78bNLq+6/Gr8s/OX1z9Kj38Bvl8PyrN7yIgmPFtMnk2tPBj8evx4LdO+U9Gj+cCRe9vvoxQBgIxqciWCKC5x2f5Habbi9G3V54Mnvz1fTRQ+/XRs39/qRWsFJaIHHEfa81CLZReDmwBgTjUxYsaOJwjXL37aiPgyY/nDwcmlF8Mn1zIN8DwaP7F7zkxdOoQ+9OJp8+lVha3kSspnnHr0/2307G8iuCBa8PPid8/lGZWoAGIBifkmCBLIkksVLJ0/EWYvnJ5NlsC26tsO8UCBJHB2+OHi8JVk5LVpKRSHWCpXlpHLAGBONTEmw6vhD08eFMiqD5v1N9MhOsdvBi+nCiTkmwclqmZ2BSnWDZ5qryYAkwBATjUxQsEWf6TNDlYVdHLV55MvnvVjhQ8W5NcipQsqFZFKOclvt5rVYwjC32BgTjUxQsaOocYUOvhW0fG1L3ZPTmt6MH7j/zeT44HXec/rMoWDkt293LbRIWBNM6oAB0gGB8ugTbCv8bq9EoWDS8Ho0i5kbQq+u7TsHSsQsINjAgGJ+KYIeLz987FVgRv6j6ZO7Nn75+JBRlOhdKYQ1WSMMabLhAMD6VfbByF695jyatXn2y9OYLXv7n7n2wQlrLPthaItj0oHdJdCALBONTWi+sZRKkAmx5D1xNHqw8Gb25YkbCRrY+2/LqRhHLaRs5gRLBDud/zh/0Vps0DAwBwfhUj4MlP6f9fO/Uff8x6fTKk6Vh+uJKSeE4WCEtOy6WHAfL0ray42Lxz2sYTrQMBOOzVhq32IiHKnKbe2vTXavyk9m+2dxzwf/vvFo8HyU3kyPa1quZyVFIi2d2ZDM50pkb0WnQsaCYydEPEIxPWbDpBMF0ZbSVOwu59GSy+ru9mD5c7PzCXMSaA8Tlj3o7GYv8r/EHpnMTH7iAuYj9AsH4VASb3HktHA+czlnPjZ+Xn0y3L/ffORoeCDteOBA2SWfLpw9XZ2CUP+rT/Gz6MDZ4+v7nMJu+byAYAIJAMAAEgWAACALBABAEggEgCAQDQBAIBoAgEAwAQSAYAIJAMAAEgWAACALBABAEggEgCAQDQBAIBoAgEAwAQSAYAIJAMAAEgWAACALBABDknwHv2+I3VFVqqgAAAABJRU5ErkJggg==" width="432" /></p>
<p>This plot gives the impression that the effect of <code>treat</code> is reversed between male and female subjects; and also that the effect of education is not monotone. Both of these are counter-intuitive.</p>
<div id="med.covred" class="section level6">
<h6></h6>
<!-- @index `cov.reduce` -->
<p>However, note that the covariate <code>emo</code> is measured <em>post</em>-treatment. That suggests that in fact <code>treat</code> (and perhaps other factors) could affect the value of <code>emo</code>; and if that is true (as is in fact established by mediation analysis techniques), we should not pretend that <code>emo</code> can be set independently of <code>treat</code> as was done to obtain the EMMs shown above. Instead, let <code>emo</code> depend on <code>treat</code> and the other predictors – easily done using <code>cov.reduce</code> – and we obtain an entirely different impression:</p>
<pre class="r"><code>emmip(framing.glm, treat ~ educ | gender, type = &quot;response&quot;, 
    cov.reduce = emo ~ treat*gender + age + educ + income)</code></pre>
<p><img src="data:image/png;base64,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" width="432" /></p>
<p>The reference grid underlying this plot has different <code>emo</code> values for each factor combination. The plot suggests that, after taking emotional response into account, male (but not female) subjects exposed to the negative news story are more likely to send the message than are females or those not seeing the negative news story. Also, the effect of <code>educ</code> is now nearly monotone.</p>
</div>
<div id="adjcov" class="section level6">
<h6></h6>
<!-- @index Covariates!Adjusted -->
<p>By the way, the results in this plot are the same is what you would obtain by refitting the model with an adjusted covariate</p>
<pre class="r"><code>emo.adj &lt;- resid(lm(emo ~ treat*gender + age + educ + income, data = framing))</code></pre>
<p>… and then using ordinary covariate-adjusted means at the means of <code>emo.adj</code>. This is a technique that is often recommended.</p>
<p>If there is more than one mediating covariate, their settings may be defined in sequence; for example, if <code>x1</code>, <code>x2</code>, and <code>x3</code> are all mediating covariates, we might use</p>
<pre class="r"><code>emmeans(..., cov.reduce = list(x1 ~ trt, x2 ~ trt + x1, x3 ~ trt + x1 + x2))</code></pre>
<p>(or possibly with some interactions included as well).</p>
<p><a href="#contents">Back to Contents</a></p>
</div>
</div>
<div id="weights" class="section level2">
<h2>Mediating factors and weights</h2>
<!-- @index Factors!Mediating; `weights`; `emmeans()`!`weights` -->
<p>A mediating covariate is one that is in the causal path; likewise, it is possible to have a mediating <em>factor</em>. For mediating factors, the moral equivalent of the <code>cov.reduce</code> technique described above is to use <em>weighted</em> averages in lieu of equally-weighted ones in computing EMMs. The weights used in these averages should depend on the frequencies of mediating factor(s). Usually, the <code>&quot;cells&quot;</code> weighting scheme described later in this section is the right approach. In complex situations, it may be necessary to compute EMMs in stages.</p>
<p>As described in <a href="basics.html#emmeans">the “basics” vignette</a>, EMMs are usually defined as <em>equally-weighted</em> means of reference-grid predictions. However, there are several built-in alternative weighting schemes that are available by specifying a character value for <code>weights</code> in a call to <code>emmeans()</code> or related function. The options are <code>&quot;equal&quot;</code> (the default), <code>&quot;proportional&quot;</code>, <code>&quot;outer&quot;</code>, <code>&quot;cells&quot;</code>, and <code>&quot;flat&quot;</code>.</p>
<p>The <code>&quot;proportional&quot;</code> (or <code>&quot;prop&quot;</code> for short) method weights proportionally to the frequencies (or model weights) of each factor combination that is averaged over. The <code>&quot;outer&quot;</code> method uses the outer product of the marginal frequencies of each factor that is being averaged over. To explain the distinction, suppose the EMMs for <code>A</code> involve averaging over two factors <code>B</code> and <code>C</code>. With <code>&quot;prop&quot;</code>, we use the frequencies for each combination of <code>B</code> and <code>C</code>; whereas for <code>&quot;outer&quot;</code>, first obtain the marginal frequencies for <code>B</code> and for <code>C</code> and weight proportionally to the product of these for each combination of <code>B</code> and <code>C</code>. The latter weights are like the “expected” counts used in a chi-square test for independence. Put another way, outer weighting is the same as proportional weighting applied one factor at a time; the following two would yield the same results:</p>
<pre class="r"><code>emmeans(model, &quot;A&quot;, weights = &quot;outer&quot;) 
emmeans(emmeans(model, c(&quot;A&quot;, &quot;B&quot;), weights = &quot;prop&quot;),  weights = &quot;prop&quot;) </code></pre>
<p>Using <code>&quot;cells&quot;</code> weights gives each prediction the same weight as occurs in the model; applied to a reference grid for a model with all interactions, <code>&quot;cells&quot;</code>-weighted EMMs are the same as the ordinary marginal means of the data. With <code>&quot;flat&quot;</code> weights, equal weights are used, except zero weight is applied to any factor combination having no data. Usually, <code>&quot;cells&quot;</code> or <code>&quot;flat&quot;</code> weighting will <em>not</em> produce non-estimable results, because we exclude empty cells. (That said, if covariates are linearly dependent with factors, we may still encounter non-estimable cases.)</p>
<p>Here is a comparison of predictions for <code>nutr.lm</code> defined <a href="#issues">above</a>, using different weighting schemes:</p>
<pre class="r"><code>sapply(c(&quot;equal&quot;, &quot;prop&quot;, &quot;outer&quot;, &quot;cells&quot;, &quot;flat&quot;), function(w)
    predict(emmeans(nutr.lm, ~ race, weights = w)))</code></pre>
<pre class="ro"><code>##         equal     prop    outer     cells      flat
## [1,] 1.258929 1.926554 2.546674 0.3809524 0.6865079
## [2,]       NA       NA       NA 1.6666667 1.2500000
## [3,] 2.932008 2.522821 3.142940 2.7951807 1.6103407</code></pre>
<p>For <code>group * race</code> EMMs, the results for <code>&quot;prop&quot;</code> and <code>&quot;flat&quot;</code> are the same because only one factor (<code>age</code>) is averaged over.</p>
<p><a href="#contents">Back to Contents</a></p>
</div>
<div id="nesting" class="section level2">
<h2>Nested fixed effects</h2>
<!-- @index Nesting -->
<p>A factor <code>A</code> is nested in another factor <code>B</code> if the levels of <code>A</code> have a different meaning in one level of <code>B</code> than in another. Often, nested factors are random effects—for example, subjects in an experiment may be randomly assigned to treatments, in which case subjects are nested in treatments—and if we model them as random effects, these random nested effects are not among the fixed effects and are not an issue to <code>emmeans</code>. But sometimes we have fixed nested factors.</p>
<div id="cows" class="section level6">
<h6></h6>
<!-- @index Examples!`cows`; Examples!Nested fixed effects -->
<p>Here is an example of a fictional study of five fictional treatments for some disease in cows. Two of the treatments are administered by injection, and the other three are administered orally. There are varying numbers of observations for each drug. The data and model follow:</p>
<pre class="r"><code>cows &lt;- data.frame (
    route = factor(rep(c(&quot;injection&quot;, &quot;oral&quot;), c(5, 9))),
    drug = factor(rep(c(&quot;Bovineumab&quot;, &quot;Charloisazepam&quot;, 
              &quot;Angustatin&quot;, &quot;Herefordmycin&quot;, &quot;Mollycoddle&quot;), c(3,2,  4,2,3))),
    resp = c(34, 35, 34,   44, 43,      36, 33, 36, 32,   26, 25,   25, 24, 24)
)
cows.lm &lt;- lm(resp ~ route + drug, data = cows)</code></pre>
<p>The <code>ref_grid</code> function finds a nested structure in this model:</p>
<pre class="r"><code>cows.rg &lt;- ref_grid(cows.lm)
cows.rg</code></pre>
<pre class="ro"><code>## 'emmGrid' object with variables:
##     route = injection, oral
##     drug = Angustatin, Bovineumab, Charloisazepam, Herefordmycin, Mollycoddle
## Nesting structure:  drug %in% route</code></pre>
<p>When there is nesting, <code>emmeans</code> computes averages separately in each group</p>
<pre class="r"><code>route.emm &lt;- emmeans(cows.rg, &quot;route&quot;)
route.emm</code></pre>
<pre class="ro"><code>##  route     emmean    SE df lower.CL upper.CL
##  injection   38.9 0.591  9     37.6     40.3
##  oral        28.0 0.449  9     27.0     29.0
## 
## Results are averaged over the levels of: drug 
## Confidence level used: 0.95</code></pre>
<p>… and insists on carrying along any grouping factors that a factor is nested in:</p>
<pre class="r"><code>drug.emm &lt;- emmeans(cows.rg, &quot;drug&quot;)
drug.emm</code></pre>
<pre class="ro"><code>##  drug           route     emmean    SE df lower.CL upper.CL
##  Bovineumab     injection   34.3 0.747  9     32.6     36.0
##  Charloisazepam injection   43.5 0.915  9     41.4     45.6
##  Angustatin     oral        34.2 0.647  9     32.8     35.7
##  Herefordmycin  oral        25.5 0.915  9     23.4     27.6
##  Mollycoddle    oral        24.3 0.747  9     22.6     26.0
## 
## Confidence level used: 0.95</code></pre>
<p>Here are the associated pairwise comparisons:</p>
<pre class="r"><code>pairs(route.emm, reverse = TRUE)</code></pre>
<pre class="ro"><code>##  contrast         estimate    SE df t.ratio p.value
##  oral - injection    -10.9 0.742  9 -14.671 &lt;.0001 
## 
## Results are averaged over the levels of: drug</code></pre>
<pre class="r"><code>pairs(drug.emm, by = &quot;route&quot;, reverse = TRUE)</code></pre>
<pre class="ro"><code>## route = injection:
##  contrast                    estimate    SE df t.ratio p.value
##  Charloisazepam - Bovineumab     9.17 1.182  9   7.757 &lt;.0001 
## 
## route = oral:
##  contrast                    estimate    SE df t.ratio p.value
##  Herefordmycin - Angustatin     -8.75 1.121  9  -7.805 0.0001 
##  Mollycoddle - Angustatin       -9.92 0.989  9 -10.030 &lt;.0001 
##  Mollycoddle - Herefordmycin    -1.17 1.182  9  -0.987 0.6026 
## 
## P value adjustment: tukey method for comparing a family of (varies) estimates</code></pre>
<p>In the latter result, the contrast itself becomes a nested factor in the returned <code>emmGrid</code> object. That would not be the case if there had been no <code>by</code> variable.</p>
</div>
<div id="nest-trap" class="section level3">
<h3>Auto-identification of nested factors – avoid being trapped!</h3>
<!-- @index Nesting!Auto-detection; `ref_grid()`!`nesting` -->
<p><code>ref_grid()</code> and <code>emmeans()</code> tries to discover and accommodate nested structures in the fixed effects. It does this in two ways: first, by identifying factors whose levels appear in combination with only one level of another factor; and second, by examining the <code>terms</code> attribute of the fixed effects. In the latter approach, if an interaction <code>A:B</code> appears in the model but <code>A</code> is not present as a main effect, then <code>A</code> is deemed to be nested in <code>B</code>. Note that this can create a trap: some users take shortcuts by omitting some fixed effects, knowing that this won’t affect the fitted values. But such shortcuts <em>do</em> affect the interpretation of model parameters, ANOVA tables, etc., and I advise against ever taking such shortcuts. Here are some ways you may notice mistakenly-identified nesting:</p>
<ul>
<li>A message is displayed when nesting is detected</li>
<li>A <code>str()</code> listing of the <code>emmGrid</code> object shows a nesting component</li>
<li>An <code>emmeans()</code> summary unexpectedly includes one or more factors that you didn’t specify</li>
<li>EMMs obtained using <code>by</code> factors don’t seem to behave right, or give the same results with different specifications</li>
</ul>
<p>To override the auto-detection of nested effects, use the <code>nesting</code> argument in <code>ref_grid()</code> or <code>emmeans()</code>. Specifying <code>nesting = NULL</code> will ignore all nesting. Incorrectly-discovered nesting can be overcome by specifying something akin to <code>nesting = &quot;A %in% B, C %in% (A * B)&quot;</code> or, equivalently, <code>nesting = list(A = &quot;B&quot;,  C = c(&quot;A&quot;, &quot;B&quot;))</code>.</p>
<p><a href="#contents">Back to Contents</a></p>
<p><a href="vignette-topics.html">Index of all vignette topics</a></p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
